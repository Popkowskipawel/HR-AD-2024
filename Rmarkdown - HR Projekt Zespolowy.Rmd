---
title: "Projekt Zespolowy HR"
date: "`r Sys.Date()`"
output:
  rmdformats::downcute:
    self_contained: true
    default_style: "light"
    downcute_theme: "default"
---

```{r setup, include=FALSE}
## Global options
knitr::opts_chunk$set(cache = TRUE)
```

```{r}
library(dplyr)
library(readr)
HR=read.csv("HR.csv")
```
## Wstęp
### Usuwanie zbędnych kolumn
```{r}
HR <- HR %>% select(-EmployeeCount, -Over18, -StandardHours) 
```
### Wykrycie duplikatów
```{r}
duplikaty <- HR[duplicated(HR) | duplicated(HR, fromLast = TRUE), ]
```
### Wartośći brakujące
```{r}
library(naniar)
vis_miss(HR)
miss_var_summary(HR)
gg_miss_upset(HR)
gg_miss_var(HR)
```
Zmienną Attrition zmienimy na typ factor
```{r}
HR$Attrition <- factor(HR$Attrition, levels = c("No", "Yes"))
```
Imputacja danych
```{r}
library(mice)
HR_imputed <- mice(HR, m= 5, maxit = 50, seed = 500)
complete_data <- complete(HR_imputed)
```

```{r}
# Funkcja do identyfikacji odstających wartości (bazuje na IQR)
find_outliers <- function(x) {
  Q1 <- quantile(x, 0.25, na.rm = TRUE)
  Q3 <- quantile(x, 0.75, na.rm = TRUE)
  IQR <- Q3 - Q1
  lower_bound <- Q1 - 1.5 * IQR
  upper_bound <- Q3 + 1.5 * IQR
  which(x < lower_bound | x > upper_bound)
}

# Zidentyfikuj odstające wartości dla kolumn liczbowych
boxplot(complete_data$YearsAtCompany)
boxplot(complete_data$NumCompaniesWorked)
boxplot(complete_data$PerformanceRating)
boxplot(complete_data$StockOptionLevel)
boxplot(complete_data$TotalWorkingYears)
```

```{r}
# Wykres słupkowy
library(ggplot2)
complete_data$OverTime <- as.factor(complete_data$OverTime)
complete_data$Attrition <- as.factor(complete_data$Attrition)
ggplot(complete_data, aes(x = OverTime, fill = Attrition)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Liczba pracowników z nadgodzinami a rotacja",
    x = "Nadgodziny",
    y = "Liczba pracowników",
    fill = "Rotacja (Attrition)"
  ) +
  theme_minimal()
```


```{r}
# Wykres słupkowy
library(ggplot2)
complete_data$MaritalStatus <- as.factor(complete_data$MaritalStatus)
complete_data$Attrition <- as.factor(complete_data$Attrition)
ggplot(complete_data, aes(x = MaritalStatus, fill = Attrition)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Stan cywilny a rotacja",
    x = "Stan cywilny",
    y = "Liczba pracowników",
    fill = "Rotacja (Attrition)"
  ) +
  theme_minimal()
```
```{r}
library(ggplot2)
library(dplyr)

# Konwersja zmiennych na odpowiednie typy
complete_data$MaritalStatus <- as.factor(complete_data$MaritalStatus)
complete_data$Attrition <- as.factor(complete_data$Attrition)

# Obliczenie procentów w każdej grupie
complete_data_summary <- complete_data %>%
  group_by(MaritalStatus, Attrition) %>%
  summarise(count = n()) %>%
  group_by(MaritalStatus) %>%
  mutate(percent = count / sum(count) * 100)

# Tworzenie wykresu
ggplot(complete_data_summary, aes(x = MaritalStatus, y = count, fill = Attrition)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = paste0(round(percent, 1), "%")), 
            position = position_dodge(width = 0.8), 
            vjust = -0.5, 
            size = 3.5) +  # Zmniejszenie czcionki procentów
  labs(
    title = "Stan cywilny a rotacja",
    x = "Stan cywilny",
    y = "Liczba pracowników",
    fill = "Rotacja (Attrition)"
  ) +
  scale_fill_manual(values = c("#4CAF50", "#FF9800")) +  # Zmiana kolorów na bardziej stonowane
  theme_minimal(base_size = 15) +  # Użycie minimalnej tematyki z większą czcionką
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),  # Obrócenie etykiet osi X
    plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),  # Wyrównanie tytułu
    legend.position = "top"  # Pozycjonowanie legendy
  )
```


```{r}
# Wykres słupkowy
library(ggplot2)=
complete_data$JobRole <- as.factor(complete_data$JobRole)
complete_data$Attrition <- as.factor(complete_data$Attrition)
ggplot(complete_data, aes(x = JobRole, fill = Attrition)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Stanowisko pracy a rotacja",
    x = "Stanowisko pracy",
    y = "Liczba pracowników",
    fill = "Rotacja (Attrition)"
  ) +
  theme_minimal()
```
```{r}
# Wykres słupkowy
library(ggplot2)
complete_data$Gender <- as.factor(complete_data$Gender)
complete_data$Attrition <- as.factor(complete_data$Attrition)
ggplot(complete_data, aes(x = Gender, fill = Attrition)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Płeć a rotacja",
    x = "Płeć",
    y = "Liczba pracowników",
    fill = "Rotacja (Attrition)"
  ) +
  theme_minimal()
```

```{r}
# Wykres słupkowy
library(ggplot2)
complete_data$EducationField <- as.factor(complete_data$EducationField)
complete_data$Attrition <- as.factor(complete_data$Attrition)
ggplot(complete_data, aes(x = EducationField, fill = Attrition)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Wykształcenie/dziedzina a rotacja",
    x = "Wykształcenie/dziedzina",
    y = "Liczba pracowników",
    fill = "Rotacja (Attrition)"
  ) +
  theme_minimal()

```

```{r}
# Wykres słupkowy
library(ggplot2)
complete_data$Department <- as.factor(complete_data$Department)
complete_data$Attrition <- as.factor(complete_data$Attrition)
ggplot(complete_data, aes(x = Department, fill = Attrition)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Dział a rotacja",
    x = "Dział",
    y = "Liczba pracowników",
    fill = "Rotacja (Attrition)"
  ) +
  theme_minimal()
```

```{r}
# Wykres słupkowy
library(ggplot2)
complete_data$BusinessTravel <- as.factor(complete_data$BusinessTravel)
complete_data$Attrition <- as.factor(complete_data$Attrition)
ggplot(complete_data, aes(x = BusinessTravel, fill = Attrition)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Podróż służbowa",
    x = "Podróż służbowa",
    y = "Liczba pracowników",
    fill = "Rotacja (Attrition)"
  ) +
  theme_minimal()
```

```{r}
# Wykres słupkowy
library(ggplot2)
complete_data$OverTime <- as.factor(complete_data$OverTime)
complete_data$Age <- as.factor(complete_data$Age)
ggplot(complete_data, aes(x = OverTime, fill = Age)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Nadgodziny a wiek",
    x = "Nadgodziny",
    y = "Liczba pracowników",
    fill = "Wiek"
  ) +
  theme_minimal()
```

```{r}
# Wykres słupkowy
library(ggplot2)
complete_data$YearsAtCompany <- as.factor(complete_data$YearsAtCompany)
complete_data$Attrition <- as.factor(complete_data$Attrition)
ggplot(complete_data, aes(x = YearsAtCompany, fill = Attrition)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Łączna liczba lat pracy",
    x = "Łączna liczba lat pracy",
    y = "Liczba pracowników",
    fill = "Rotacja (Attrition)"
  ) +
  theme_minimal()
```

```{r}
# Wykres słupkowy
library(ggplot2)
complete_data$Education <- as.factor(complete_data$Education)
complete_data$Attrition <- as.factor(complete_data$Attrition)
ggplot(complete_data, aes(x = Education, fill = Attrition)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Edu",
    x = "Edu",
    y = "Liczba pracowników",
    fill = "Rotacja (Attrition)"
  ) +
  theme_minimal()
```

```{r}
# Wykres słupkowy
library(ggplot2)
complete_data$NumCompaniesWorked <- as.factor(complete_data$NumCompaniesWorked)
complete_data$Attrition <- as.factor(complete_data$Attrition)
ggplot(complete_data, aes(x = NumCompaniesWorked, fill = Attrition)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Liczba przepracowanych firm",
    x = "Liczba przepracowanych firm",
    y = "Liczba pracowników",
    fill = "Rotacja (Attrition)"
  ) +
  theme_minimal()
```
```{r}
ggplot(complete_data, aes(x = NumCompaniesWorked, fill = Attrition)) +
  geom_bar(position = "dodge") +
  facet_wrap(~Gender) +
  labs(
    title = "Liczba przepracowanych firm w zależności od rotacji i płci",
    x = "Liczba przepracowanych firm",
    y = "Liczba pracowników",
    fill = "Rotacja (Attrition)"
  ) +
  theme_minimal()
```
```{r}

```


```{r}
complete_data %>%
  group_by(DistanceFromHome, Attrition) %>%
  summarise(count = n()) %>%
  group_by(DistanceFromHome) %>%
  mutate(percentage = count / sum(count) * 100) %>%
  ggplot(aes(x = DistanceFromHome, y = percentage, fill = Attrition)) +
  geom_bar(stat = "identity", position = "fill") +
  labs(
    title = "Procentowy rozkład rotacji według dystansu od miejsca pracy",
    x = "Dystans od miejsca pracy",
    y = "Procent (%)"
  ) +
  theme_minimal()
```
#Podsumowanie projektu "Projekt Zespołowy HR"

#Projekt "Projekt Zespołowy HR" skupił się na analizie czynników wpływających na rotację pracowników (attrition) w organizacji. Wykorzystując zestaw danych dotyczący zatrudnienia, przeprowadziliśmy kompleksowe przetwarzanie danych, analizę opisową oraz wizualizację wyników.

#Główne etapy analizy

#Przygotowanie danych

#Usunięcie zbędnych kolumn i duplikatów.

#Identyfikacja i imputacja brakujących danych przy użyciu metody wielokrotnej imputacji (mice).

#Identyfikacja i analiza danych odstających.

#Analiza opisowa

#Wizualizacja zależności między zarobkami a rotacją pracowników.

#Obliczenie statystyk opisowych dla dochodów w kontekście attrition.

#Wizualizacja danych

#Mapa korelacji: Ukazująca związki między zmiennymi liczbowymi.

#Analiza nadgodzin: Pracownicy pracujący nadgodziny wykazują wyższy poziom rotacji.

#Rotacja według stanowiska: Największa rotacja dotyczy Sales Representative (39.8%) i Laboratory Technician (24.3%).

#Analiza płci: Rotacja jest wyższa wśród mężczyzn (17%) niż kobiet (14.6%).

#Analiza wieku: Młodsi pracownicy są bardziej skłonni do zmiany pracy.

#Odległość od miejsca pracy: Pracownicy mieszkający dalej od firmy mają wyższy współczynnik rotacji.

#Wnioski

#Na podstawie przeprowadzonych analiz możemy stwierdzić, że rotacja pracowników jest zależna od wielu czynników, takich jak zarobki, stanowisko, wiek, płeć oraz odległość do miejsca pracy. Wyniki mogą posłużyć organizacjom do opracowania skuteczniejszych strategii retencji pracowników, np. poprzez dostosowanie polityki wynagrodzeń, oferowanie elastycznych form zatrudnienia czy wprowadzenie programów wsparcia dla pracowników mieszkających daleko od biura.

#Projekt dostarcza cennych wskazówek dla zespołów HR i menedżerów, pomagając w optymalizacji zarządzania zasobami ludzkimi oraz redukcji kosztów związanych z rotacją pracowników.


